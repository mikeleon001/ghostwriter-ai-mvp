@startuml GhostWriter_Class_Diagram_Refactored
!pragma layout smetana

' ============================================
' DESIGN PATTERN 1: SINGLETON - Database
' ============================================
class Database <<Singleton>> {
  - {static} instance: Database
  - connectionString: String
  - status: String
  - Database() {private}
  + {static} getInstance(): Database
  + store()
  + retrieve()
  + update()
  + delete()
  + backup()
  + optimizeQuery()
}

note right of Database
  **Singleton Pattern**
  Makes sure only one database
  connection exists throughout
  the application lifecycle.
end note

' ============================================
' DESIGN PATTERN 2: STRATEGY - Analysis
' ============================================
interface AnalysisStrategy {
  + analyze(conversation: Conversation): AnalysisResult
}

class TopicExtractionStrategy {
  + analyze(conversation: Conversation): AnalysisResult
  - extractKeywords(messages: List<Message>): List<String>
  - rankTopics(keywords: List<String>): Map<String, Integer>
}

class SentimentAnalysisStrategy {
  + analyze(conversation: Conversation): AnalysisResult
  - analyzeSentiment(message: Message): String
  - calculateOverallSentiment(sentiments: List<String>): String
}

class ActionItemStrategy {
  + analyze(conversation: Conversation): AnalysisResult
  - identifyTasks(messages: List<Message>): List<String>
  - findQuestions(messages: List<Message>): List<String>
}

class StatisticsStrategy {
  + analyze(conversation: Conversation): AnalysisResult
  - calculateMessageCount(conversation: Conversation): Map
  - analyzeTimeDistribution(messages: List<Message>): Map
}

' Layout directives to stack strategies vertically
TopicExtractionStrategy -[hidden]down- SentimentAnalysisStrategy
SentimentAnalysisStrategy -[hidden]down- ActionItemStrategy
ActionItemStrategy -[hidden]down- StatisticsStrategy

AnalysisStrategy <|.. TopicExtractionStrategy
AnalysisStrategy <|.. SentimentAnalysisStrategy
AnalysisStrategy <|.. ActionItemStrategy
AnalysisStrategy <|.. StatisticsStrategy

class Analyzer {
  - analyzerId: String
  - strategies: List<AnalysisStrategy>
  + setStrategies(strategies: List<AnalysisStrategy>)
  + addStrategy(strategy: AnalysisStrategy)
  + analyzeConversation(conversation: Conversation): AnalysisResult
  + performAnalysis(conversation: Conversation): AnalysisResult
}

Analyzer o--> "1..*" AnalysisStrategy : uses

note right of AnalysisStrategy
  **Strategy Pattern**
  Allows different analysis algorithms
  to be selected at runtime. Each strategy
  performs a specific type of analysis.
end note

' ============================================
' Supporting Classes for Analysis
' ============================================
class AnalysisResult {
  - resultId: String
  - conversationId: String
  - analyzedDate: DateTime
  - topics: Map<String, Integer>
  - sentiment: String
  - actionItems: List<String>
  - questions: List<String>
  - statistics: Map<String, Object>
  + getTopics(): Map<String, Integer>
  + getSentiment(): String
  + getActionItems(): List<String>
  + getStatistics(): Map<String, Object>
}

Analyzer --> AnalysisResult : creates
AnalysisStrategy ..> AnalysisResult : produces

' ============================================
' Original Classes (unchanged or minor updates)
' ============================================
class User {
  - userId: String
  - username: String
  - email: String
  - password: String
  - createdDate: Date
  + register()
  + login()
  + uploadConversations()
  + reviewSummary()
  + configurePreferences()
  + monitorActivity()
}

class Account {
  - accountId: String
  - username: String
  - passwordHash: String
  - email: String
  - isActive: Boolean
  + create()
  + validate()
  + update()
  + deactivate()
}

class Profile {
  - profileId: String
  - userId: String
  - communicationStyle: String
  - vocabulary: List<String>
  - responsePatterns: Map
  - timingPreferences: Map
  - confidenceScore: Float
  + createProfile()
  + analyzeWritingStyle()
  + updateStyle()
  + getPersonalizationData()
}

class GhostWriterSystem {
  - systemId: String
  - version: String
  - status: String
  + coordinateOperations()
  + authenticateUser()
  + processMessage()
  + generateResponse()
  + scheduleDelivery()
  + createSummary()
  + maintainSecurity()
}

class Message {
  - messageId: String
  - senderId: String
  - recipientId: String
  - content: String
  - timestamp: DateTime
  - status: String
  - platform: String
  + store()
  + retrieve()
  + trackDelivery()
  + formatContent()
}

class Response {
  - responseId: String
  - messageId: String
  - content: String
  - generatedAt: DateTime
  - scheduledFor: DateTime
  - status: String
  - approved: Boolean
  + generate()
  + schedule()
  + send()
  + trackStatus()
  + allowModification()
}

class Conversation {
  - conversationId: String
  - participants: List<String>
  - messages: List<Message>
  - startDate: DateTime
  - lastActivity: DateTime
  + organize()
  + maintainContext()
  + archive()
  + search()
  + filter()
}

class AIModel {
  - modelId: String
  - version: String
  - accuracy: Float
  + processText()
  + generateResponse()
  + analyzeSentiment()
  + learnStyle()
  + update()
}

class Schedule {
  - scheduleId: String
  - responseId: String
  - scheduledTime: DateTime
  - delayMinutes: Integer
  - priority: Integer
  + calculateTiming()
  + queueMessage()
  + manageQueue()
  + handleConflicts()
}

class Summary {
  - summaryId: String
  - userId: String
  - date: Date
  - keyTopics: List<String>
  - actionItems: List<String>
  - urgentMatters: List<String>
  + generate()
  + aggregate()
  + format()
  + send()
}

class Platform {
  - platformId: String
  - platformName: String
  - apiEndpoint: String
  + connect()
  + sendMessage()
  + receiveMessage()
  + authenticate()
}

class Administrator {
  - adminId: String
  - username: String
  - permissions: List<String>
  + monitorSystem()
  + updateModel()
  + configureSettings()
  + handleSupport()
  + scheduleMaintenance()
}

class Authentication {
  - sessionId: String
  - token: String
  - expiresAt: DateTime
  + authenticate()
  + validate()
  + generateToken()
  + logout()
}

class Backup {
  - backupId: String
  - timestamp: DateTime
  - size: Long
  - location: String
  + create()
  + verify()
  + restore()
  + deleteOld()
}

class Notification {
  - notificationId: String
  - userId: String
  - message: String
  - type: String
  - sentAt: DateTime
  + create()
  + send()
  + markRead()
}

' ============================================
' Relationships
' ============================================
User "1" -- "1" Account : has
User "1" -- "1" Profile : has
User "1" -- "*" Conversation : participates in
User "1" -- "*" Notification : receives

GhostWriterSystem "1" -- "*" User : manages
GhostWriterSystem "1" -- "1" AIModel : uses
GhostWriterSystem "1" -- "1" Database : stores in
GhostWriterSystem "1" -- "*" Message : processes
GhostWriterSystem "1" -- "*" Response : generates
GhostWriterSystem "1" -- "1" Authentication : validates with

Message "1" -- "1" Response : generates
Message "*" -- "1" Conversation : belongs to
Message "*" -- "1" Analyzer : analyzed by

Response "1" -- "1" Schedule : scheduled by
Response "1" -- "1" Platform : sent via

Conversation "*" -- "1" Summary : summarized in
Conversation "1" -- "1" AnalysisResult : produces

AIModel "1" -- "1" Analyzer : works with
AIModel "1" -- "1" Profile : uses

Profile "1" -- "1" Analyzer : analyzed by

Database "1" -- "*" Backup : creates
Database "1" -- "*" Profile : stores
Database "1" -- "*" Message : stores
Database "1" -- "*" Conversation : stores
Database "1" -- "*" AnalysisResult : stores

Administrator "1" -- "1" GhostWriterSystem : manages
Administrator "1" -- "1" AIModel : updates
Administrator "1" -- "1" Database : manages

Platform "1" -- "*" Message : transmits

Schedule "1" -- "1" Response : manages

Summary "1" -- "1" AnalysisResult : uses

@enduml
